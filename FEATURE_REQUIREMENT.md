# 功能需求文档：AI 智能助手页面

## 需求概述
创建一个新的页面和 UI 组件，用于测试和展示 AI 模型功能，为用户提供智能对话、情感分析和内容生成服务。

## 需求背景
- 需要一个新的界面来测试 AI 模型功能
- 需要展示模型的能力和效果
- 需要良好的用户交互体验

## 功能需求

### 1. 页面结构
- **页面路径**: `pages/ai-assistant/ai-assistant`
- **导航栏标题**: "AI 智能助手"
- **添加到 tabBar**: 可选，或通过"发现"页面进入

### 2. 核心功能模块

#### 2.1 智能对话功能
- **输入区域**: 
  - 文本输入框（支持多行输入）
  - 发送按钮
  - 清空按钮
- **对话历史区域**:
  - 显示对话历史（用户消息和 AI 回复）
  - 支持滚动查看
  - 区分用户消息和 AI 消息的样式
- **功能特性**:
  - 实时对话交互
  - 加载状态提示
  - 错误处理提示

#### 2.2 情感分析功能
- **输入**: 用户输入一段文字（日记、心情描述等）
- **输出**: 
  - 情感倾向（正面/中性/负面）
  - 情感强度（1-10分）
  - 关键词提取
  - 情感分析报告

#### 2.3 智能内容生成
- **功能选项**:
  - 生成情话
  - 生成恋爱建议
  - 生成纪念日祝福语
  - 生成约会建议
- **输入参数**:
  - 可选的个性化参数（关系天数、节日类型等）
- **输出**: 生成的内容展示

#### 2.4 模型测试面板
- **API 测试区域**:
  - 显示 API 调用状态
  - 显示响应时间
  - 显示模型版本/信息
  - 测试连接按钮
- **诊断功能**:
  - API 密钥配置
  - 网络连接测试
  - 错误日志查看

### 3. UI/UX 设计要求

#### 3.1 视觉风格
- 保持与现有项目风格一致（粉色主题 #ff69b4）
- 现代化的卡片式设计
- 柔和的渐变背景
- 圆角设计，友好的视觉体验

#### 3.2 交互设计
- 流畅的动画过渡
- 清晰的加载状态提示
- 友好的错误提示
- 支持下拉刷新
- 响应式布局

#### 3.3 组件设计
- **对话气泡**: 用户消息和 AI 消息使用不同的样式区分
- **卡片组件**: 用于展示功能模块
- **按钮组件**: 统一的按钮样式
- **输入框组件**: 支持多行输入的文本输入框

### 4. 技术实现要求

#### 4.1 API 接口设计
- 创建 `utils/aiService.js` 用于封装 AI 模型调用
- 支持多种 AI 服务（OpenAI、百度文心、阿里通义等）
- 统一的错误处理和重试机制
- 请求参数验证

#### 4.2 数据管理
- 对话历史本地存储（使用 wx.setStorage）
- 支持清空对话历史
- 支持导出对话记录

#### 4.3 性能优化
- 对话历史虚拟滚动（如果数据量大）
- API 请求防抖处理
- 错误重试机制
- 加载状态优化

### 5. 页面文件结构
```
pages/ai-assistant/
├── ai-assistant.js       # 页面逻辑
├── ai-assistant.json     # 页面配置
├── ai-assistant.wxml     # 页面结构
└── ai-assistant.wxss     # 页面样式
```

### 6. 功能优先级

#### P0 (核心功能)
- [ ] 基础页面结构搭建
- [ ] 智能对话功能（基础版）
- [ ] 输入输出界面

#### P1 (重要功能)
- [ ] 情感分析功能
- [ ] 智能内容生成（生成情话）
- [ ] API 测试面板

#### P2 (增强功能)
- [ ] 对话历史存储
- [ ] 更多内容生成选项
- [ ] 模型诊断功能
- [ ] 导出对话记录

### 7. 测试要点
- 测试不同长度文本的处理
- 测试网络异常情况
- 测试 API 限流处理
- 测试用户体验流畅度
- 测试不同设备适配

### 8. 后续扩展
- 语音输入功能
- 图片分析功能
- 多模态交互
- 个性化推荐
- 情感趋势分析

## 实现建议
1. 先实现基础的对话界面和 API 调用框架
2. 集成一个可用的 AI API（如 OpenAI 或国内服务）
3. 逐步完善各个功能模块
4. 优化用户体验和性能

