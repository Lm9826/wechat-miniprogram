<!--diary.wxml-->
<view class="diary-container">
  <view class="header">
    <text class="title">å†™æ—¥è®°</text>
    <text class="subtitle">ç”¨ç…§ç‰‡è®°å½•ç¾å¥½ç¬é—´</text>
  </view>

  <!-- ä»Šå¤©çš„æ¶ˆæ¯ -->
  <view class="today-message-section">
    <view class="today-message-header">
      <text class="today-title">ğŸ“ ä»Šå¤©çš„æ¶ˆæ¯</text>
      <text class="today-date">{{todayMessage ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'}}</text>
    </view>
    
    <view class="today-message-content" wx:if="{{todayMessage}}">
      <text class="message-text">{{todayMessage}}</text>
    </view>
    
    <view class="today-message-actions">
      <button class="message-btn" bindtap="showAddMessageModal">
        {{todayMessage ? 'ä¿®æ”¹æ¶ˆæ¯' : 'æ·»åŠ æ¶ˆæ¯'}}
      </button>
    </view>
  </view>

  <view class="add-diary-btn" bindtap="addDiary">
    <text class="add-icon">+</text>
    <text class="add-text">å†™ä¸‹ä»Šå¤©çš„å¿ƒæƒ…</text>
  </view>

  <view class="diary-list">
    <view class="diary-item" wx:for="{{diaryList}}" wx:key="id" bindtap="viewDiary" data-id="{{item.id}}">
      <view class="diary-date">{{item.date}}</view>
      <view class="diary-content">
        <view class="diary-title">{{item.title}}</view>
        <view class="diary-text">{{item.content}}</view>
      </view>
      <view class="diary-mood {{item.mood}}"></view>
    </view>
  </view>

  <!-- æ·»åŠ æ¶ˆæ¯å¼¹çª— -->
  <view class="message-modal" wx:if="{{showAddMessage}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">è®¾ç½®ä»Šå¤©çš„æ¶ˆæ¯</text>
        <text class="modal-close" bindtap="hideAddMessageModal">Ã—</text>
      </view>
      <view class="modal-body">
        <textarea class="message-input" 
                  placeholder="å†™ä¸‹ä»Šå¤©æƒ³è¯´çš„è¯ï¼Œä¼šåœ¨æ¨é€ä¸­æ˜¾ç¤º..."
                  value="{{todayMessage}}"
                  bindinput="onMessageInput"
                  maxlength="200"></textarea>
        <text class="input-tip">è¿™æ¡æ¶ˆæ¯ä¼šåœ¨æ¯æ—¥æ¨é€ä¸­æ˜¾ç¤ºç»™æ‚¨çš„ä¼´ä¾£</text>
      </view>
      <view class="modal-footer">
        <button class="modal-btn cancel" bindtap="hideAddMessageModal">å–æ¶ˆ</button>
        <button class="modal-btn confirm" bindtap="saveTodayMessage">ä¿å­˜</button>
      </view>
    </view>
  </view>
</view>
